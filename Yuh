-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

-- Configuration
local ESPColor = Color3.fromRGB(255, 0, 0) -- Red color for outlines
local NameColors = {Color3.fromRGB(255, 0, 0), Color3.fromRGB(0, 255, 0), Color3.fromRGB(0, 0, 255), Color3.fromRGB(255, 255, 0)} -- Different colors for names
local NAME_SCALE = Vector3.new(0.5, 0.5, 0.5) -- Scale for name tags

-- Function to create ESP for a player
local function createESP(player)
    local character = player.Character
    if character then
        for _, part in ipairs(character:GetChildren()) do
            if part:IsA("BasePart") and not part:FindFirstChild("ESPBox") then
                local espBox = Instance.new("BoxHandleAdornment", part)
                espBox.Name = "ESPBox"
                espBox.Adornee = part
                espBox.Size = part.Size
                espBox.Color3 = ESPColor
                espBox.Transparency = 0.5
                espBox.AlwaysOnTop = true
                espBox.ZIndex = 1
                espBox.Visible = true
            end
        end

        if not character:FindFirstChild("ESPNameTag") then
            local billBoard = Instance.new("BillboardGui", character)
            billBoard.Name = "ESPNameTag"
            billBoard.Size = UDim2.new(0, 200, 0, 50)
            billBoard.Adornee = character:FindFirstChild("Head")
            billBoard.AlwaysOnTop = true

            local nameLabel = Instance.new("TextLabel", billBoard)
            nameLabel.Size = UDim2.new(1, 0, 1, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.Text = player.Name
            nameLabel.TextColor3 = NameColors[math.random(1, #NameColors)]
            nameLabel.TextScaled = true
            nameLabel.Font = Enum.Font.SourceSansBold
        end
    end
end

-- Create ESP for existing players
for _, player in pairs(Players:GetPlayers()) do
    if player ~= Players.LocalPlayer then
        player.CharacterAdded:Connect(function()
            wait(1) -- Wait for character to load
            createESP(player)
        end)
        if player.Character then
            createESP(player)
        end
    end
end

-- Create ESP for new players
Players.PlayerAdded:Connect(function(player)
    if player ~= Players.LocalPlayer then
        player.CharacterAdded:Connect(function()
            wait(1) -- Wait for character to load
            createESP(player)
        end)
    end
end)
