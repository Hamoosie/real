-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")

-- Configuration
local ESPColor = Color3.fromRGB(255, 0, 0) -- Red color for outlines
local NameColors = {Color3.fromRGB(255, 0, 0), Color3.fromRGB(0, 255, 0), Color3.fromRGB(0, 0, 255), Color3.fromRGB(255, 255, 0)} -- Different colors for names
local NAME_SCALE = UDim2.new(0, 100, 0, 20) -- Size for name tags
local NAME_OFFSET = Vector3.new(0, 3, 0) -- Offset for name tags

-- Function to create ESP for a player
local function createESP(player)
    local character = player.Character
    if character then
        -- Create an outline for the entire character
        local outline = Instance.new("Highlight")
        outline.Name = "ESPOutline"
        outline.FillTransparency = 1
        outline.OutlineColor = ESPColor
        outline.Parent = character

        if not character:FindFirstChild("ESPNameTag") then
            -- Create a billboard for the player's name
            local billBoard = Instance.new("BillboardGui", character)
            billBoard.Name = "ESPNameTag"
            billBoard.Size = NAME_SCALE
            billBoard.Adornee = character:FindFirstChild("Head")
            billBoard.AlwaysOnTop = true
            billBoard.StudsOffset = NAME_OFFSET

            local nameLabel = Instance.new("TextLabel", billBoard)
            nameLabel.Size = UDim2.new(1, 0, 1, 0)
            nameLabel.BackgroundTransparency = 1
            nameLabel.Text = player.Name
            nameLabel.TextColor3 = NameColors[math.random(1, #NameColors)]
            nameLabel.TextScaled = true
            nameLabel.Font = Enum.Font.SourceSansBold
            nameLabel.TextSize = 8 -- Smaller text size
        end
    end
end

-- Create ESP for existing players
for _, player in pairs(Players:GetPlayers()) do
    if player ~= Players.LocalPlayer then
        player.CharacterAdded:Connect(function()
            wait(1) -- Wait for character to load
            createESP(player)
        end)
        if player.Character then
            createESP(player)
        end
    end
end

-- Create ESP for new players
Players.PlayerAdded:Connect(function(player)
    if player ~= Players.LocalPlayer then
        player.CharacterAdded:Connect(function()
            wait(1) -- Wait for character to load
            createESP(player)
        end)
    end
end)
