-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

-- Configuration
local HITBOX_SIZE = Vector3.new(10, 10, 10) -- Size of the hitbox box
local HITBOX_COLOR = Color3.fromRGB(255, 0, 0) -- Red color for the hitbox
local HITBOX_TRANSPARENCY = 0.5 -- Transparency level of the hitbox

-- Function to create a visual hitbox around a player
local function createHitbox(player)
    local character = player.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then
        return
    end

    -- Remove existing hitbox if it exists
    local existingHitbox = character:FindFirstChild("Hitbox")
    if existingHitbox then
        existingHitbox:Destroy()
    end

    -- Create a new hitbox
    local hitbox = Instance.new("Part")
    hitbox.Name = "Hitbox"
    hitbox.Anchored = true
    hitbox.CanCollide = false
    hitbox.BrickColor = BrickColor.new(HITBOX_COLOR)
    hitbox.Transparency = HITBOX_TRANSPARENCY
    hitbox.Size = HITBOX_SIZE
    hitbox.CFrame = character.HumanoidRootPart.CFrame
    hitbox.Parent = character

    -- Update hitbox size and position continuously
    local function updateHitbox()
        if character and character:FindFirstChild("HumanoidRootPart") then
            hitbox.Size = HITBOX_SIZE
            hitbox.CFrame = character.HumanoidRootPart.CFrame
        end
    end

    -- Connect to RenderStepped to keep hitbox updated
    RunService.RenderStepped:Connect(updateHitbox)
end

-- Function to check if a player is hit
local function checkHit()
    local mouse = Players.LocalPlayer:GetMouse()
    local target = mouse.Target
    if target and target:IsA("Part") and target.Name == "Hitbox" then
        local player = Players:GetPlayers()
        for _, p in ipairs(player) do
            if p.Character and p.Character:FindFirstChild("Hitbox") == target then
                -- Apply damage to the player (example)
                local humanoid = p.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid:TakeDamage(10) -- Apply 10 damage (adjust as needed)
                end
            end
        end
    end
end

-- Create hitboxes for all players already in the game
for _, player in ipairs(Players:GetPlayers()) do
    if player ~= Players.LocalPlayer then
        player.CharacterAdded:Connect(function()
            createHitbox(player)
        end)
        
        -- Create hitbox if the character is already in the game
        if player.Character then
            createHitbox(player)
        end
    end
end

-- Create hitboxes for players who join the game
Players.PlayerAdded:Connect(function(player)
    if player ~= Players.LocalPlayer then
        player.CharacterAdded:Connect(function()
            createHitbox(player)
        end)
    end
end)

-- Check for hits on the player's mouse click
Players.LocalPlayer:GetMouse().Button1Down:Connect(checkHit)
